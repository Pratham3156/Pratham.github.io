<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

   .avatar-initials {
  width: 120px;
  height: 120px;
  background: #1db954;
  color: black;
  font-size: 40px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  margin: 20px auto;
}
    </style>
</head>
<body>

<div class="profile-card">
 <img id="profileImage" class="profile-img" src="default-avatar.png">
  <div class="avatar-initials" id="avatarInitials">
    P
  </div>

  <h2 id="usernameText">Player</h2>
  <p id="emailText"></p>

</div>
  <script type="module">
    import { auth } from "./firebase.js";
    import { onAuthStateChanged, signOut } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const nameEl = document.getElementById("userName");
    const emailEl = document.getElementById("userEmail");
    const imageEl = document.getElementById("profileImage");

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        location.replace("login.html");
        return;
      }

      nameEl.innerText = user.displayName || "User";
      emailEl.innerText = user.email;

      if (user.photoURL) {
        imageEl.src = user.photoURL;
      }
    });

    window.logout = function () {
      signOut(auth).then(() => {
        location.replace("login.html");
      });
    };

    window.goBack = function () {
      history.back();
    };
  </script>
<script type="module">
import { auth } from "./firebase.js";
import { onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

function extractInitials(email) {
  let name = email.split("@")[0];

  // remove numbers & special characters
  name = name.replace(/[^a-zA-Z]/g, "");

  if (!name) return "P";

  return name.charAt(0).toUpperCase() +
         (name.charAt(1)?.toUpperCase() || "");
}

onAuthStateChanged(auth, (user) => {
  if (!user) {
    location.href = "login.html";
    return;
  }

  const cleanName = user.email.split("@")[0];

  document.getElementById("usernameText").innerText = cleanName;
  document.getElementById("emailText").innerText = user.email;
  document.getElementById("avatarInitials").innerText =
    extractInitials(user.email);
});
</script>
</body>
</html>
